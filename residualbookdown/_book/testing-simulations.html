<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>A Minimal Book Example</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="A Minimal Book Example">
  <meta name="generator" content="bookdown 0.0.80 and GitBook 2.6.7">

  <meta property="og:title" content="A Minimal Book Example" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A Minimal Book Example" />
  
  
  

<meta name="author" content="Yihui Xie">

<meta name="date" content="2016-07-13">

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="description-of-simulation-framework.html">
<link rel="next" href="comparing-with-the-old-code.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="description-of-simulation-framework.html"><a href="description-of-simulation-framework.html"><i class="fa fa-check"></i><b>3</b> Description of Simulation Framework</a></li>
<li class="chapter" data-level="4" data-path="testing-simulations.html"><a href="testing-simulations.html"><i class="fa fa-check"></i><b>4</b> Testing Simulations</a></li>
<li class="chapter" data-level="5" data-path="comparing-with-the-old-code.html"><a href="comparing-with-the-old-code.html"><i class="fa fa-check"></i><b>5</b> Comparing with the old code</a></li>
<li class="chapter" data-level="6" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>6</b> Final Words</a><ul>
<li class="chapter" data-level="6.1" data-path="final-words.html"><a href="final-words.html#testing-under-et-model"><i class="fa fa-check"></i><b>6.1</b> Testing Under ET Model</a></li>
<li class="chapter" data-level="6.2" data-path="final-words.html"><a href="final-words.html#posteriors-with-ee"><i class="fa fa-check"></i><b>6.2</b> Posteriors with EE</a></li>
<li class="chapter" data-level="6.3" data-path="final-words.html"><a href="final-words.html#posteriors-with-et"><i class="fa fa-check"></i><b>6.3</b> Posteriors With ET</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.rstudio.com" target="blank">Published with RStudio Press</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Minimal Book Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="testing-simulations" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Testing Simulations</h1>
<p>To test the simulations are accurate, make sure that the covariance of the nulls is the same as the covariance of the errors. This should be true because under the simulation framework above,</p>
<p><span class="math">\(\hat{\beta}_{null}=0+E\)</span></p>
<pre class="sourceCode r"><code class="sourceCode r">(<span class="kw">cov</span>(s$betahat[<span class="dv">401</span>:<span class="dv">1000</span>,])[<span class="dv">1</span>:<span class="dv">5</span>,<span class="dv">1</span>:<span class="dv">5</span>])</code></pre>
<pre><code>##             V1          V2          V3          V4          V5
## V1 0.011537213 0.008843323 0.008783923 0.009307824 0.008813660
## V2 0.008843323 0.010796276 0.008371736 0.008835393 0.008388811
## V3 0.008783923 0.008371736 0.010829103 0.008890581 0.008411636
## V4 0.009307824 0.008835393 0.008890581 0.012011765 0.008812083
## V5 0.008813660 0.008388811 0.008411636 0.008812083 0.010608879</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">(<span class="kw">cov</span>(s$error[<span class="dv">401</span>:<span class="dv">1000</span>,])[<span class="dv">1</span>:<span class="dv">5</span>,<span class="dv">1</span>:<span class="dv">5</span>])</code></pre>
<pre><code>##             [,1]        [,2]        [,3]        [,4]        [,5]
## [1,] 0.011537213 0.008843323 0.008783923 0.009307824 0.008813660
## [2,] 0.008843323 0.010796276 0.008371736 0.008835393 0.008388811
## [3,] 0.008783923 0.008371736 0.010829103 0.008890581 0.008411636
## [4,] 0.009307824 0.008835393 0.008890581 0.012011765 0.008812083
## [5,] 0.008813660 0.008388811 0.008411636 0.008812083 0.010608879</code></pre>
<p>You can see they are the same.</p>
<p>And most importantly, we want to make sure that this resembles the <em>true</em> residual matrix since for all j, <span class="math">\(E \sim N(0,V)\)</span></p>
<pre class="sourceCode r"><code class="sourceCode r">s$var.mat[<span class="dv">1</span>:<span class="dv">5</span>,<span class="dv">1</span>:<span class="dv">5</span>]</code></pre>
<pre><code>##             [,1]        [,2]        [,3]        [,4]        [,5]
## [1,] 0.012390065 0.009778049 0.009638546 0.009922640 0.009854220
## [2,] 0.009778049 0.012057322 0.009508241 0.009788494 0.009720999
## [3,] 0.009638546 0.009508241 0.011715734 0.009648842 0.009582310
## [4,] 0.009922640 0.009788494 0.009648842 0.012416548 0.009864746
## [5,] 0.009854220 0.009720999 0.009582310 0.009864746 0.012245907</code></pre>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="description-of-simulation-framework.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="comparing-with-the-old-code.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/inst/examples/03-method.Rmd",
"text": "Edit"
},
"download": ["bookdown-demo.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
